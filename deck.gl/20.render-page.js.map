{"version":3,"sources":["webpack://lib/../node_modules/@arcgis/core/chunks/quickselect.js","webpack://lib/../node_modules/@arcgis/core/core/MemCache.js","webpack://lib/../node_modules/@arcgis/core/core/sql/WhereClauseCache.js","webpack://lib/../node_modules/@arcgis/core/geometry/support/intersects.js","webpack://lib/../node_modules/@arcgis/core/geometry/support/quantizationUtils.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/centroid.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/contains.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/AttributesBuilder.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/timeSupport.js","webpack://lib/../node_modules/@arcgis/core/layers/graphics/data/utils.js","webpack://lib/../node_modules/@arcgis/core/layers/support/PromiseQueue.js","webpack://lib/../node_modules/@arcgis/core/smartMapping/statistics/support/utils.js"],"names":[],"mappings":"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","file":"20.render-page.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nvar r,t,o,a={exports:{}};r=a,t=function(){function r(r,o,n,f,e){t(r,o,n||0,f||r.length-1,e||a)}function t(r,a,n,f,e){for(;f>n;){if(f-n>600){var h=f-n+1,i=a-n+1,u=Math.log(h),M=.5*Math.exp(2*u/3),v=.5*Math.sqrt(u*M*(h-M)/h)*(i-h/2<0?-1:1);t(r,a,Math.max(n,Math.floor(a-i*M/h+v)),Math.min(f,Math.floor(a+(h-i)*M/h+v)),e)}var x=r[a],c=n,p=f;for(o(r,n,a),e(r[f],x)>0&&o(r,n,f);c<p;){for(o(r,c,p),c++,p--;e(r[c],x)<0;)c++;for(;e(r[p],x)>0;)p--}0===e(r[n],x)?o(r,n,p):o(r,++p,f),p<=a&&(n=p+1),a<=p&&(f=p-1)}}function o(r,t,o){var a=r[t];r[t]=r[o],r[o]=a}function a(r,t){return r<t?-1:r>t?1:0}return r},void 0!==(o=t())&&(r.exports=o);var n=a.exports;export{n as q};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport t from\"./PooledArray.js\";const e=-3;class s{constructor(t,e,s){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=\":\",s&&(this._storage.registerRemoveFunc(this._namespace,s),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(t,e,s,i=0){this._storage.put(this._namespace+t,e,s,i)}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,s){this._storage.updateSize(this._namespace+t,e,s)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class i{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new t,this._users=new t}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,s,i,h){const r=this._db.get(t);if(r&&(this._size-=r.size,this._db.delete(t),r.entry!==s&&this._notifyRemoved(t,r.entry)),i>this._maxSize)return void this._notifyRemoved(t,s);if(void 0===s)return void console.warn(\"Refusing to cache undefined entry \");if(!i||i<0)return void console.warn(\"Refusing to cache entry with invalid size \"+i);const _=1+Math.max(h,e)-e;this._db.set(t,{entry:s,size:i,lifetime:_,lives:_}),this._size+=i,this._checkSizeLimit()}updateSize(t,e,s){const i=this._db.get(t);if(i&&i.entry===e){if(this._size-=i.size,s>this._maxSize)return this._db.delete(t),void this._notifyRemoved(t,e);i.size=s,this._size+=s,this._checkSizeLimit()}}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+\"/\"+Math.round(this._maxSize/1048576)+\"MB\",\"Hit rate\":Math.round(100*this._getHitRate())+\"%\",Entries:this._db.size.toString()},s={},i=new Array;this._db.forEach(((t,e)=>{const h=t.lifetime;i[h]=(i[h]||0)+t.size,this._users.forAll((i=>{const h=i.namespace;if(e.startsWith(h)){const e=s[h]||0;s[h]=e+t.size}}))}));const h={};this._users.forAll((t=>{const e=t.namespace;if(!isNaN(t.hitRate)&&t.hitRate>0){const i=s[e]||0;s[e]=i,h[e]=Math.round(100*t.hitRate)+\"%\"}else h[e]=\"0%\"}));const r=Object.keys(s);r.forEach((t=>s[t]=s[t]/this._size*100)),r.sort(((t,e)=>s[e]-s[t])),r.forEach((e=>t[e]=Math.round(s[e])+\"% / \"+h[e]));for(let _=i.length-1;_>=0;--_){const s=i[_];s&&(t[\"Priority \"+(_+e-1)]=Math.round(s/this.size*100)+\"%\")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){this._db.forEach(((e,s)=>{s.startsWith(t)&&(this._size-=e.size,this._db.delete(s),this._notifyRemoved(s,e.entry))}))}clearAll(){this._db.forEach(((t,e)=>this._notifyRemoved(e,t.entry))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(t,e){this._removeFuncs.forAll((s=>{t.startsWith(s[0])&&s[1](e)}))}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db)if(this._db.delete(t),e.lives<=1?(this._size-=e.size,this._notifyRemoved(t,e.entry)):(--e.lives,this._db.set(t,e)),this._size<=.9*this.maxSize)return}}export{e as MIN_PRIORITY,s as MemCache,i as MemCacheStorage};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport t from\"../ItemCache.js\";import{WhereClause as e}from\"./WhereClause.js\";class c{constructor(e,c){this._cache=new t(e),this._invalidCache=new t(c)}get(t,c){const i=`${c.uid}:${t}`,r=this._cache.get(i);if(r)return r;if(void 0!==this._invalidCache.get(i))return null;try{const r=e.create(t,c);return this._cache.put(i,r),r}catch{return this._invalidCache.put(i,null),null}}}export{c as WhereClauseCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{extentIntersectsExtent as e,getFeatureExtentIntersector as t}from\"./intersectsBase.js\";export{extentIntersectsExtent,extentIntersectsMultipoint,extentIntersectsPoint,extentIntersectsPolygon,extentIntersectsPolyline,getFeatureExtentIntersector,isSelfIntersecting,segmentIntersects}from\"./intersectsBase.js\";function n(n){return\"mesh\"===n?e:t(n)}export{n as getExtentIntersector};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as n,isNone as t}from\"../../core/maybe.js\";import{isPoint as r,isPolyline as e,isPolygon as u,isMultipoint as i,isExtent as o}from\"./jsonUtils.js\";function l(n){return n&&\"upperLeft\"===n.originPosition}const a=(n,t,r)=>[t,r],m=(n,t,r)=>[t,r,n[2]],c=(n,t,r)=>[t,r,n[2],n[3]];function s(n){if(!n)return null;return{originPosition:\"upper-left\"===n.originPosition?\"upperLeft\":\"lower-left\"===n.originPosition?\"lowerLeft\":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}}function f(n,t){if(n===t||null==n&&null==t)return!0;if(null==n||null==t)return!1;let r,e,u,i,o,a;return l(n)?(r=n.translate[0],e=n.translate[1],u=n.scale[0]):(r=n.extent.xmin,e=n.extent.ymax,u=n.tolerance),l(t)?(i=t.translate[0],o=t.translate[1],a=t.scale[0]):(i=t.extent.xmin,o=t.extent.ymax,a=t.tolerance),r===i&&e===o&&u===a}function x({scale:n,translate:t},r){return Math.round((r-t[0])/n[0])}function h({scale:n,translate:t},r){return Math.round((t[1]-r)/n[1])}function I(n,t,r){const e=[];let u,i,o,l;for(let a=0;a<r.length;a++){const m=r[a];a>0?(o=x(n,m[0]),l=h(n,m[1]),o===u&&l===i||(e.push(t(m,o-u,l-i)),u=o,i=l)):(u=x(n,m[0]),i=h(n,m[1]),e.push(t(m,u,i)))}return e.length>0?e:null}function g(n,t,r){return t[0]=x(n,r[0]),t[3]=h(n,r[1]),t[2]=x(n,r[2]),t[1]=h(n,r[3]),t}function p(n,t,r,e){return I(n,r?e?c:m:e?m:a,t)}function N(n,t,r,e){const u=[],i=r?e?c:m:e?m:a;for(let o=0;o<t.length;o++){const r=I(n,i,t[o]);r&&r.length>=3&&u.push(r)}return u.length?u:null}function y(n,t,r,e){const u=[],i=r?e?c:m:e?m:a;for(let o=0;o<t.length;o++){const r=I(n,i,t[o]);r&&r.length>=2&&u.push(r)}return u.length?u:null}function z({scale:n,translate:t},r){return r*n[0]+t[0]}function T({scale:n,translate:t},r){return t[1]-r*n[1]}function M(n,t,r){const e=new Array(r.length);if(!r.length)return e;const[u,i]=n.scale;let o=z(n,r[0][0]),l=T(n,r[0][1]);e[0]=t(r[0],o,l);for(let a=1;a<r.length;a++){const n=r[a];o+=n[0]*u,l-=n[1]*i,e[a]=t(n,o,l)}return e}function E(n,t,r){const e=new Array(r.length);for(let u=0;u<r.length;u++)e[u]=M(n,t,r[u]);return e}function P(n,t,r){return r?(t[0]=z(n,r[0]),t[1]=T(n,r[3]),t[2]=z(n,r[2]),t[3]=T(n,r[1]),t):[z(n,t[0]),T(n,t[3]),z(n,t[2]),T(n,t[1])]}function b(n,t,r,e){return M(n,r?e?c:m:e?m:a,t)}function F(n,t,r,e){return E(n,r?e?c:m:e?m:a,t)}function V(n,t,r,e){return E(n,r?e?c:m:e?m:a,t)}function Y(n,t,r){let[e,u]=r[0],i=Math.min(e,t[0]),o=Math.min(u,t[1]),l=Math.max(e,t[2]),a=Math.max(u,t[3]);for(let m=1;m<r.length;m++){const[n,t]=r[m];e+=n,u+=t,n<0&&(i=Math.min(i,e)),n>0&&(l=Math.max(l,e)),t<0?o=Math.min(o,u):t>0&&(a=Math.max(a,u))}return n[0]=i,n[1]=o,n[2]=l,n[3]=a,n}function _(n,t){if(!t.length)return null;n[0]=n[1]=Number.POSITIVE_INFINITY,n[2]=n[3]=Number.NEGATIVE_INFINITY;for(let r=0;r<t.length;r++)Y(n,n,t[r]);return n}function A(n){const t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return Y(t,t,n)}function w(n){return _([0,0,0,0],n)}function j(n){return _([0,0,0,0],n)}function G(n,t,r,e,u){return t.xmin=x(n,r.xmin),t.ymin=h(n,r.ymin),t.xmax=x(n,r.xmax),t.ymax=h(n,r.ymax),t!==r&&(e&&(t.zmin=r.zmin,t.zmax=r.zmax),u&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function L(n,t,r,e,u){return t.points=p(n,r.points,e,u),t}function O(n,t,r,e,u){return t.x=x(n,r.x),t.y=h(n,r.y),t!==r&&(e&&(t.z=r.z),u&&(t.m=r.m)),t}function S(n,t,r,e,u){const i=N(n,r.rings,e,u);return i?(t.rings=i,t):null}function d(n,t,r,e,u){const i=y(n,r.paths,e,u);return i?(t.paths=i,t):null}function U(n,t){return n&&t?r(t)?O(n,{},t,!1,!1):e(t)?d(n,{},t,!1,!1):u(t)?S(n,{},t,!1,!1):i(t)?L(n,{},t,!1,!1):o(t)?G(n,{},t,!1,!1):null:null}function k(n,t,r,e,u){return t.xmin=z(n,r.xmin),t.ymin=T(n,r.ymin),t.xmax=z(n,r.xmax),t.ymax=T(n,r.ymax),t!==r&&(e&&(t.zmin=r.zmin,t.zmax=r.zmax),u&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function q(t,r,e,u,i){return n(e)&&(r.points=b(t,e.points,u,i)),r}function v(n,r,e,u,i){return t(e)||(r.x=z(n,e.x),r.y=T(n,e.y),r!==e&&(u&&(r.z=e.z),i&&(r.m=e.m))),r}function B(t,r,e,u,i){return n(e)&&(r.rings=V(t,e.rings,u,i)),r}function C(t,r,e,u,i){return n(e)&&(r.paths=F(t,e.paths,u,i)),r}export{f as equals,Y as getQuantizedBoundsCoordsArray,_ as getQuantizedBoundsCoordsArrayArray,w as getQuantizedBoundsPaths,A as getQuantizedBoundsPoints,j as getQuantizedBoundsRings,g as quantizeBounds,G as quantizeExtent,U as quantizeGeometry,L as quantizeMultipoint,y as quantizePaths,O as quantizePoint,p as quantizePoints,S as quantizePolygon,d as quantizePolyline,N as quantizeRings,x as quantizeX,h as quantizeY,s as toQuantizationTransform,P as unquantizeBounds,M as unquantizeCoordsArray,E as unquantizeCoordsArrayArray,k as unquantizeExtent,q as unquantizeMultipoint,F as unquantizePaths,v as unquantizePoint,b as unquantizePoints,B as unquantizePolygon,C as unquantizePolyline,V as unquantizeRings,z as unquantizeX,T as unquantizeY};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../core/maybe.js\";function n(t,n){return t?n?4:3:n?3:2}function e(e,o,u,l,N){if(t(o)||!o.lengths.length)return null;const s=\"upperLeft\"===(null==N?void 0:N.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,f=[],i=u?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:T,coords:h}=o,g=n(u,l);let E=0;for(const t of T){const n=r(i,h,E,t,u,l,s);n&&f.push(n),E+=t*g}if(f.sort(((t,n)=>{let e=s*t[2]-s*n[2];return 0===e&&u&&(e=t[4]-n[4]),e})),f.length){let t=6*f[0][2];c[0]=f[0][0]/t,c[1]=f[0][1]/t,u&&(t=6*f[0][4],c[2]=0!==t?f[0][3]/t:0),(c[0]<i[0]||c[0]>i[1]||c[1]<i[2]||c[1]>i[3]||u&&(c[2]<i[4]||c[2]>i[5]))&&(c.length=0)}if(!c.length){const t=o.lengths[0]?I(h,0,T[0],u,l):null;if(!t)return null;c[0]=t[0],c[1]=t[1],u&&t.length>2&&(c[2]=t[2])}return e}function r(t,e,r,I,o,u,l=1){const N=n(o,u);let s=r,c=r+N,f=0,i=0,T=0,h=0,g=0;for(let n=0,m=I-1;n<m;n++,s+=N,c+=N){const n=e[s],r=e[s+1],I=e[s+2],u=e[c],l=e[c+1],N=e[c+2];let E=n*l-u*r;h+=E,f+=(n+u)*E,i+=(r+l)*E,o&&(E=n*N-u*I,T+=(I+N)*E,g+=E),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),o&&(I<t[4]&&(t[4]=I),I>t[5]&&(t[5]=I))}if(h*l>0&&(h*=-1),g*l>0&&(g*=-1),!h)return null;const E=[f,i,.5*h];return o&&(E[3]=T,E[4]=.5*g),E}function I(t,e,r,I,s){const c=n(I,s);let f=e,i=e+c,T=0,h=0,g=0,E=0;for(let n=0,m=r-1;n<m;n++,f+=c,i+=c){const n=t[f],e=t[f+1],r=t[f+2],s=t[i],c=t[i+1],m=t[i+2],b=I?u(n,e,r,s,c,m):o(n,e,s,c);if(b)if(T+=b,I){const t=N(n,e,r,s,c,m);h+=b*t[0],g+=b*t[1],E+=b*t[2]}else{const t=l(n,e,s,c);h+=b*t[0],g+=b*t[1]}}return T>0?I?[h/T,g/T,E/T]:[h/T,g/T]:r>0?I?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function o(t,n,e,r){const I=e-t,o=r-n;return Math.sqrt(I*I+o*o)}function u(t,n,e,r,I,o){const u=r-t,l=I-n,N=o-e;return Math.sqrt(u*u+l*l+N*N)}function l(t,n,e,r){return[t+.5*(e-t),n+.5*(r-n)]}function N(t,n,e,r,I,o){return[t+.5*(r-t),n+.5*(I-n),e+.5*(o-e)]}export{e as getCentroidOptimizedGeometry,I as lineCentroid};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nfunction n(n,t){return n?t?4:3:t?3:2}function t(n,t,r,e){return o(n,t,r,e.coords[0],e.coords[1])}function r(t,r,e,c,u,f){const s=n(u,f),{coords:i,lengths:l}=c;if(!l)return!1;for(let n=0,d=0;n<l.length;n++,d+=s)if(!o(t,r,e,i[d],i[d+1]))return!1;return!0}function o(t,r,o,c,u){if(!t)return!1;const f=n(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=e(l,s,f,d,n,c,u),d+=n*f;return l}function e(n,t,r,o,e,c,u){let f=n,s=o;for(let i=o,l=o+e*r;i<l;i+=r){s=i+r,s===l&&(s=o);const n=t[i],e=t[i+1],d=t[s],g=t[s+1];(e<u&&g>=u||g<u&&e>=u)&&n+(u-e)/(g-e)*(d-n)<c&&(f=!f)}return f}export{o as polygonContainsCoords,r as polygonContainsMultipoint,t as polygonContainsPoint};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../../core/maybe.js\";import{getExpressionFromFieldName as e,getWhereClause as s,getAliasFromFieldName as i}from\"./attributeSupport.js\";import{getNormalizedValue as a}from\"../../../smartMapping/statistics/support/utils.js\";class r{constructor(t,a,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=a;const l=t.outFields;if(l&&-1===l.indexOf(\"*\")){this.outFields=l;let t=0;for(const a of l){const l=e(a),u=this.fieldsIndex.get(l),n=u?null:s(l,r),c=u?u.name:i(a)||\"FIELD_EXP_\"+t++;this._fieldDataCache.set(a,{alias:c,clause:n})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,i){const a=i?i.name:e;let r=null;return this._fieldDataCache.has(a)?r=this._fieldDataCache.get(a).clause:i||(r=s(e,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:r})),i?this.featureAdapter.getAttribute(t,a):r.calculateValue(t,this.featureAdapter)}getNormalizedValue(t,e){const s=e.normalizationType,i=e.normalizationTotal;let r=this.getFieldValue(t,e.field,e.fieldInfo);if(s&&Number.isFinite(r)){const l=this.getFieldValue(t,e.normalizationField,e.normalizationFieldInfo);r=a(r,s,l,i)}return r}getExpressionValue(t,e,s){const i={attributes:this.featureAdapter.getAttributes(t)},a=s.createExecContext(i,e.viewInfo);return s.executeFunction(e.compiledFunc,a)}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:s(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testFeature(t,this.featureAdapter)}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:s(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const s={};for(const i of e){const{alias:e,clause:a}=this._fieldDataCache.get(i);s[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return s}_processAttributesForDistinctValues(e){if(t(e)||!this.returnDistinctValues)return e;const s=this.outFields,i=[];if(s)for(const t of s){const{alias:s}=this._fieldDataCache.get(t);i.push(e[s])}else for(const t in e)i.push(e[t]);const a=`${(s||[\"*\"]).join(\",\")}=${i.join(\",\")}`;let r=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++r),r>1?null:e}}export{r as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{clone as t}from\"../../../core/lang.js\";import{isNone as i,isUndefined as s}from\"../../../core/maybe.js\";import{MemCacheStorage as r,MemCache as a}from\"../../../core/MemCache.js\";import{getMetersPerUnitForSR as n}from\"../../../core/unitUtils.js\";import{create as u,set as o,NEGATIVE_INFINITY as c,expandWithAABB as h}from\"../../../geometry/support/aaBoundingBox.js\";import{fromValues as l,create as m}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as p}from\"../../../geometry/support/boundsUtils.js\";import{fromJSON as d,isExtent as y,isPolygon as f}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as _}from\"../../../geometry/support/normalizeUtils.js\";import{equals as x,isValid as g}from\"../../../geometry/support/spatialReferenceUtils.js\";import{validateFields as w,validateWhere as S,validateHaving as Q,hasInvalidFieldType as R}from\"./attributeSupport.js\";import{project as I,checkProjectionSupport as F}from\"./projectionSupport.js\";import{queryCapabilities as b}from\"./QueryEngineCapabilities.js\";import j from\"./QueryEngineResult.js\";import{getSpatialQueryOperator as A,canQueryWithRBush as E,checkSpatialQuerySupport as k}from\"./spatialQuerySupport.js\";import{getTimeExtent as C}from\"./timeSupport.js\";import{cleanFromGeometryEngine as T,normalizeQuery as B,QUERY_ENGINE_EMPTY_RESULT as O}from\"./utils.js\";import z from\"../../support/FieldsIndex.js\";import P from\"../../support/PromiseQueue.js\";import{loadArcade as G}from\"../../../support/arcadeOnDemand.js\";function v(e){return e.every((e=>\"exceedslimit\"!==e.statisticType))}const q=\"feature-store:unsupported-query\";class M{constructor(e,t=null,i,s,r){this.attributes=e,this.geometry=i,this.centroid=s,this.filterFlags=r,this.groupId=-1,this.displayId=t}}const U=new Set,N=new r(2e6);let Z=0;class D{constructor(e){this.capabilities={query:b},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on(\"changed\",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new a(Z+++\"$$\",N)),this.fieldsIndex=new z(e.fields),e.scheduler&&e.priority&&(this._frameQueue=new P,this._frameTask=e.scheduler.registerTask(e.priority,this))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:T(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=C(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e={},i){let s,r=t(e);try{r=await this._schedule((()=>B(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i)}catch(a){if(a!==O)throw a;s=new j([],null,this)}return s.createQueryResponse(r)}async executeQueryForCount(e={},i){let s,r=t(e);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=await this._schedule((()=>B(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i)}catch(a){if(a!==O)throw a;return 0}return s.createQueryResponseForCount(r)}async executeQueryForExtent(e={},i){let s,r=t(e);const a=r.outSR;try{r=await this._schedule((()=>B(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),r.returnGeometry=!0,r.returnCentroid=!1,r.outSR=null,s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i);const e=s.size;if(!e)return{count:e,extent:null};o(J,c),this.featureStore.forEachBounds(s.items,(e=>h(J,e)),H);const t={xmin:J[0],ymin:J[1],xmax:J[3],ymax:J[4],spatialReference:T(this.spatialReference)};this.hasZ&&isFinite(J[2])&&isFinite(J[5])&&(t.zmin=J[2],t.zmax=J[5]);const u=I(t,s.spatialReference,a);if(u.spatialReference=T(a||this.spatialReference),u.xmax-u.xmin==0){const e=n(u.spatialReference);u.xmin-=e,u.xmax+=e}if(u.ymax-u.ymin==0){const e=n(u.spatialReference);u.ymin-=e,u.ymax+=e}if(this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0){const e=n(u.spatialReference);u.zmin-=e,u.zmax+=e}return{count:e,extent:u}}catch(u){if(u===O)return{count:0,extent:null};throw u}}async executeQueryForIds(e={},t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e={},i){let s,r=t(e);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=await this._schedule((()=>B(r,this.definitionExpression,this.spatialReference)),i),r=await this._reschedule((()=>this._checkQuerySupport(r)),i),s=await this._reschedule((()=>this._executeGeometryQuery(r,i)),i),s=await this._reschedule((()=>s.executeAggregateIdsQuery(r)),i),s=await this._reschedule((()=>s.executeObjectIdsQuery(r)),i),s=await this._reschedule((()=>s.executeTimeQuery(r)),i),s=await this._reschedule((()=>s.executeAttributesQuery(r)),i);const e=s.items,t=new Set;return await this._reschedule((()=>{for(const i of e)t.add(s.featureAdapter.getObjectId(i))}),i),t}catch(a){if(a===O)return new Set;throw a}}async executeQueryForSnapping(e,t){const{point:s,distance:r,types:a}=e;if(0===a)return{candidates:[]};const n=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),u=!x(s.spatialReference,this.spatialReference);u&&await F(s.spatialReference,this.spatialReference);const o=\"number\"==typeof r?r:r.x,c=\"number\"==typeof r?r:r.y,h={xmin:s.x-o,xmax:s.x+o,ymin:s.y-c,ymax:s.y+c,spatialReference:s.spatialReference},l=u?I(h,this.spatialReference):h;if(!l)return{candidates:[]};const m=(await _(d(s),null,{signal:t}))[0],p=(await _(d(l),null,{signal:t}))[0];if(i(m)||i(p))return{candidates:[]};let y=new j(this._searchFeatures(this._getQueryBBoxes(p.toJSON())),null,this);y=await this._reschedule((()=>y.executeObjectIdsQuery(n)),t),y=await this._reschedule((()=>y.executeTimeQuery(n)),t),y=await this._reschedule((()=>y.executeAttributesQuery(n)),t);const f=m.toJSON(),g=u?I(f,this.spatialReference):f,w=u?Math.max(l.xmax-l.xmin,l.ymax-l.ymin)/2:r;return y.createSnappingResponse({...e,point:g,distance:w},s.spatialReference)}async executeQueryForLatestObservations(i={},s){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new e(q,\"Missing timeInfo or timeInfo.trackIdField\",{query:i,timeInfo:this.timeInfo});let r,a=t(i);try{a=await this._schedule((()=>B(a,this.definitionExpression,this.spatialReference)),s),a=await this._reschedule((()=>this._checkQuerySupport(a)),s),r=await this._reschedule((()=>this._executeGeometryQuery(a,s)),s),r=await this._reschedule((()=>r.executeAggregateIdsQuery(a)),s),r=await this._reschedule((()=>r.executeObjectIdsQuery(a)),s),r=await this._reschedule((()=>r.executeTimeQuery(a)),s),r=await this._reschedule((()=>r.executeAttributesQuery(a)),s),r=await this._reschedule((()=>r.filterLatest()),s)}catch(n){if(n!==O)throw n;r=new j([],null,this)}return r.createQueryResponse(a)}async executeQueryForSummaryStatistics(e={},i,s){let r;e=t(e);try{e=await this._schedule((()=>B(e,this.definitionExpression,this.spatialReference)),s),e=await this._reschedule((()=>this._checkSummaryStatisticsSupport(e,i)),s),r=await this._reschedule((()=>this._executeGeometryQuery(e,s)),s),r=await this._reschedule((()=>r.executeAggregateIdsQuery(e)),s),r=await this._reschedule((()=>r.executeObjectIdsQuery(e)),s),r=await this._reschedule((()=>r.executeTimeQuery(e)),s),r=await this._reschedule((()=>r.executeAttributesQuery(e)),s)}catch(a){if(a!==O)throw a;r=new j([],null,this)}return r.createSummaryStatisticsResponse(e,i)}async _schedule(e,t){return this._frameQueue?this._frameQueue.push(e,t):e()}async _reschedule(e,t){return this._frameQueue?this._frameQueue.unshift(e,t):e()}get running(){return this._frameQueue.length>0}runTask(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach((t=>e.push(t))),this._allItems=new j(e,null,this)}return this._allItems}async _executeGeometryQuery(e,t){const{geometry:i,outSR:r,spatialRel:a,returnGeometry:n,returnCentroid:u}=e,o=n||u,c=g(r)&&!x(this.spatialReference,r),h=this._geometryQueryCache?c&&o?JSON.stringify({geometry:i,spatialRelationship:a,outSpatialReference:r}):JSON.stringify({geometry:i,spatialRelationship:a}):null;if(h){const e=this._geometryQueryCache.get(h);if(!s(e))return e}const l=async e=>{if(c&&o){const t=await e.project(r);return h&&this._geometryQueryCache.put(h,t,t.size||1),t}return h&&this._geometryQueryCache.put(h,e,e.size||1),e};if(!i)return l(this._getAll());const m=this.featureAdapter;if(\"esriSpatialRelDisjoint\"===a){const e=this._searchFeatures(this._getQueryBBoxes(i));if(!e.length)return l(this._getAll());let s,r;const n=new Set;for(const t of e)n.add(m.getObjectId(t));await this._reschedule((()=>{let e=0;s=new Array(n.size),this.featureStore.forEach((t=>s[e++]=t)),r=n}),t);const u=await this._reschedule((async()=>{const e=await A(a,i,this.geometryType,this.hasZ,this.hasM),n=t=>!r.has(m.getObjectId(t))||e(m.getGeometry(t));return new j(await this._runSpatialFilter(s,n,t),i,this)}),t);return l(u)}const p=this._searchFeatures(this._getQueryBBoxes(i));if(!p.length){const e=new j([],i,this);return h&&this._geometryQueryCache.put(h,e,e.size||1),e}if(this._canExecuteSoloPass(i,e))return l(new j(p,i,this));const d=await A(a,i,this.geometryType,this.hasZ,this.hasM),y=await this._runSpatialFilter(p,(e=>d(m.getGeometry(e))),t);return l(new j(y,i,this))}async _runSpatialFilter(e,t,i){if(!t)return e;if(!this._budget)return e.filter((e=>t(e)));let s=0;const r=new Array,a=async()=>{for(;s<e.length;){const n=e[s];t(n)&&r.push(n),this._budget.done&&await this._reschedule((()=>a()),i),++s}};return this._reschedule((()=>a()),i).then((()=>r))}_canExecuteSoloPass(e,t){const{geometryType:i}=this,{spatialRel:s}=t;return E(e)&&(\"esriSpatialRelEnvelopeIntersects\"===s||\"esriGeometryPoint\"===i&&(\"esriSpatialRelIntersects\"===s||\"esriSpatialRelContains\"===s||\"esriSpatialRelWithin\"===s))}_getQueryBBoxes(e){if(E(e)){if(y(e))return[l(e.xmin,e.ymin,e.xmax,e.ymax)];if(f(e))return e.rings.map((e=>l(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[p(m(),e)]}_searchFeatures(e){for(const s of e)this.featureStore.forEachInBounds(s,(e=>{U.add(e)}));const t=new Array(U.size);let i=0;return U.forEach((e=>t[i++]=e)),U.clear(),t}async _checkSummaryStatisticsSupport(t,i){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new e(q,\"Unsupported query options\",{query:t});return Promise.all([this._checkAttributesQuerySupport(t),this._checkSummaryStatisticsParamsSupport(i),k(t,this.geometryType,this.spatialReference),F(this.spatialReference,t.outSR)]).then((()=>t))}async _checkSummaryStatisticsParamsSupport(t){let i=[];if(t.valueExpression){const{arcadeUtils:e}=await G();i=e.extractFieldNames(t.valueExpression)}if(t.field&&i.push(t.field),t.normalizationField&&i.push(t.normalizationField),!i.length)throw new e(q,\"params should have at least a field or valueExpression\",{params:t});w(this.fieldsIndex,i,\"params contains missing fields\")}async _checkQuerySupport(t){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new e(q,\"Unsupported query options\",{query:t});return Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),k(t,this.geometryType,this.spatialReference),F(this.spatialReference,t.outSR)]).then((()=>t))}_checkAttributesQuerySupport(t){const{outFields:i,orderByFields:s,returnDistinctValues:r,outStatistics:a}=t,n=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())):[];if(s&&s.length>0){const e=\" asc\",t=\" desc\",i=s.map((i=>{const s=i.toLowerCase();return s.indexOf(e)>-1?s.split(e)[0]:s.indexOf(t)>-1?s.split(t)[0]:i})).filter((e=>-1===n.indexOf(e)));w(this.fieldsIndex,i,\"orderByFields contains missing fields\")}if(i&&i.length>0)w(this.fieldsIndex,i,\"outFields contains missing fields\");else if(r)throw new e(q,\"outFields should be specified for returnDistinctValues\",{query:t});S(this.fieldsIndex,t.where)}async _checkStatisticsQuerySupport(t){const{outStatistics:i,groupByFieldsForStatistics:s,having:r}=t,a=s&&s.length,n=i&&i.length;if(r){if(!a||!n)throw new e(q,\"outStatistics and groupByFieldsForStatistics should be specified with having\",{query:t});Q(this.fieldsIndex,r,i)}if(n){if(!v(i))return;const r=i.map((e=>e.onStatisticField));w(this.fieldsIndex,r,\"onStatisticFields contains missing fields\"),a&&w(this.fieldsIndex,s,\"groupByFieldsForStatistics contains missing fields\");for(const s of i){const{onStatisticField:i,statisticType:r}=s;if((\"percentile_disc\"===r||\"percentile_cont\"===r)&&\"statisticParameters\"in s){const{statisticParameters:i}=s;if(!i)throw new e(q,\"statisticParamters should be set for percentile type\",{definition:s,query:t})}else if(\"count\"!==r&&i&&R(i,this.fieldsIndex))throw new e(q,\"outStatistics contains non-numeric fields\",{definition:s,query:t})}}}}const H=u(),J=u();export{M as Feature,D as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nconst t={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};export{t as queryCapabilities};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as t}from\"../../../core/maybe.js\";import{toQuantizationTransform as s}from\"../../../geometry/support/quantizationUtils.js\";import{isValid as i,equals as r}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as n}from\"../featureConversionUtils.js\";import a from\"./AttributesBuilder.js\";import{getWhereClause as o}from\"./attributeSupport.js\";import{project as u,projectMany as l}from\"./projectionSupport.js\";import{getTimeOperator as c}from\"./timeSupport.js\";import{cleanFromGeometryEngine as d,getGeometry as h,transformCentroid as m}from\"./utils.js\";import{isStringField as f}from\"../../support/fieldUtils.js\";import{isNullCountSupported as p,calculateStringStatistics as g,calculateStatistics as y,processStatsResult as I}from\"../../../smartMapping/statistics/support/utils.js\";import{loadArcade as b}from\"../../../support/arcadeOnDemand.js\";function x(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function F(e,t,s){return(s?e>t:e<t)?-1:(s?e<t:e>t)?1:0}function T(e,t,s){return s?t-e:e-t}function V(e,t,s,i){if(s&&\"esriFieldTypeDate\"===s.type){const s=new Date(e).getTime(),r=new Date(t).getTime();if(!isNaN(s)&&!isNaN(r))return T(s,r,i)}if(\"number\"==typeof e&&\"number\"==typeof t)return T(e,t,i);if(\"string\"==typeof e&&\"string\"==typeof t){const r=e.toUpperCase(),n=t.toUpperCase();return!s||\"esriFieldTypeGUID\"!==s.type&&\"esriFieldTypeGlobalID\"!==s.type?F(r,n,i):F(x(r),x(n),i)}return i?1:-1}class A{constructor(e,t,s){this.items=e,this.queryGeometry=t,this.definitionExpression=s.definitionExpression,this.geometryType=s.geometryType,this.hasM=s.hasM,this.hasZ=s.hasZ,this.objectIdField=s.objectIdField,this.spatialReference=s.spatialReference,this.fieldsIndex=s.fieldsIndex,this.timeInfo=s.timeInfo,this.featureAdapter=s.featureAdapter,this.aggregateAdapter=s.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new a(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:s,having:i}=e;if(!!!(null==s?void 0:s.length))return 1;const r=new Map,n=new Map,o=new Set,u=e.outStatistics;for(const a of u){const{statisticType:e}=a,u=\"exceedslimit\"!==e?a.onStatisticField:void 0;if(!n.has(u)){const e=[];for(const i of s){const s=this._getAttributeValues(t,i,r);e.push(s)}n.set(u,this._calculateUniqueValues(e,t.returnDistinctValues))}const l=n.get(u);for(const s in l){const{data:e,items:r}=l[s],n=e.join(\",\");i&&!t.validateItems(r,i)||o.add(n)}}return o.size}createQueryResponse(e){let t;if(e.outStatistics){t=e.outStatistics.some((e=>\"exceedslimit\"===e.statisticType))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e)}else t=this._createFeatureQueryResponse(e);return e.returnQueryGeometry&&(i(e.outSR)&&!r(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=d({spatialReference:e.outSR,...u(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=d({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(t,s){const i=this.featureAdapter,r=_(this.hasZ,this.hasM),{x:n,y:a}=t.point,o=\"number\"==typeof t.distance?t.distance:t.distance.x,u=\"number\"==typeof t.distance?t.distance:t.distance.y,l={candidates:[]},c=\"esriGeometryPolygon\"===this.geometryType,d=this.getPointCreator(t.point,this.spatialReference,s);for(const h of this.items){const s=i.getGeometry(h);if(e(s))continue;const{coords:m,lengths:f}=s;if(1&t.types){let e=0;for(let t=0;t<f.length;t++){const s=f[t];for(let t=0;t<s;t++,e+=r){const c=m[e],f=m[e+1];if(t!==s-1){const t=m[e+r],s=m[e+r+1],{x:p,y:g}=S(n,a,c,f,t,s),y=(n-p)/o,I=(a-g)/u,b=y*y+I*I;b<=1&&l.candidates.push({type:\"edge\",objectId:i.getObjectId(h),distance:Math.sqrt(b),target:d(p,g),start:d(c,f),end:d(t,s)})}}}}if(2&t.types){const e=c?m.length-r:m.length;for(let t=0;t<e;t+=r){const e=m[t],s=m[t+1],r=(n-e)/o,c=(a-s)/u,f=r*r+c*c;f<=1&&l.candidates.push({type:\"vertex\",objectId:i.getObjectId(h),distance:Math.sqrt(f),target:d(e,s)})}}}return l.candidates.sort(((e,t)=>e.distance-t.distance)),l}getPointCreator(e,s,i){const n=t(i)&&!r(s,i)?e=>u(e,s,i):e=>e;return null!=e.z&&null!=e.m?(t,s)=>n({x:t,y:s,z:e.z,m:e.m}):null!=e.z?(t,s)=>n({x:t,y:s,z:e.z}):null!=e.m?(t,s)=>n({x:t,y:s,m:e.m}):(e,t)=>n({x:e,y:t})}executeAttributesQuery(e){const t=o(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let s=0;const i=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(i[s++]=e);const r=new A(i,this.queryGeometry,this);return r.definitionExpression=e.where,Promise.resolve(r)}return Promise.reject(new TypeError(\"Where clause is not standardized\"))}executeAggregateIdsQuery(t){if(!t.aggregateIds||!t.aggregateIds.length||e(this.aggregateAdapter))return Promise.resolve(this);const s=new Set;for(const e of t.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(e).forEach((e=>s.add(e)))}const i=this.featureAdapter.getObjectId;return Promise.resolve(new A(this.items.filter((e=>s.has(i(e)))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),s=this.featureAdapter.getObjectId;return Promise.resolve(new A(this.items.filter((e=>t.has(s(e)))),this.queryGeometry,this))}executeTimeQuery(e){const s=c(this.timeInfo,e.timeExtent,this.featureAdapter);if(!t(s))return Promise.resolve(this);const i=this.items.filter(s);return Promise.resolve(new A(i,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:s}=this.timeInfo,i=s||t,r=new Map,n=this.featureAdapter.getAttribute;for(const o of this.items){const t=n(o,e),s=n(o,i),a=r.get(t);(!a||s>n(a,i))&&r.set(t,o)}const a=Array.from(r.values());return Promise.resolve(new A(a,this.queryGeometry,this))}async project(e){if(!e||r(this.spatialReference,e))return this;const t=this.featureAdapter,s=(await l(this.items.map((e=>h(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e)))),this.spatialReference,e)).map(((e,s)=>t.cloneWithGeometry(this.items[s],n(e,this.hasZ,this.hasM))));return new A(s,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}async createSummaryStatisticsResponse(e,t){const{field:s,normalizationField:i,normalizationType:r,normalizationTotal:n,minValue:o,maxValue:u}=t,l=new a(e,this.featureAdapter,this.fieldsIndex),c=this.fieldsIndex.isDateField(s),d=t.valueExpression?await this._getAttributeExpressionValues(l,t.valueExpression,t.viewInfoParams):this._getAttributeNormalizedValues(l,{field:s,normalizationField:i,normalizationType:r,normalizationTotal:n}),h=p({normalizationType:r,normalizationField:i,minValue:o,maxValue:u}),m=f(this.fieldsIndex.get(s))?g({values:d,supportsNullCount:h}):y({values:d,minValue:o,maxValue:u,useSampleStdDev:!r,supportsNullCount:h});return I(m,c)}_sortFeatures(e,t,s){if(e.length>1&&t&&t.length)for(const i of t.reverse()){const t=i.split(\" \"),r=t[0],n=this.fieldsIndex.get(r),a=t[1]&&\"desc\"===t[1].toLowerCase();e.sort(((e,t)=>V(s(e,r,n),s(t,r,n),n,a)))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:r,hasZ:n,objectIdField:a,spatialReference:o}=this,{outFields:u,outSR:l,quantizationParameters:c,resultRecordCount:h,resultOffset:m,returnZ:f,returnM:p}=e,g=null!=h&&t.length>(m||0)+h,y=u&&(u.indexOf(\"*\")>-1?[...this.fieldsIndex.fields]:u.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:g,features:this._createFeatures(e,t),fields:y,geometryType:i,hasM:r&&p,hasZ:n&&f,objectIdFieldName:a,spatialReference:d(l||o),transform:c&&s(c)||null}}_createFeatures(e,t){const i=new a(e,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:n}=this,{orderByFields:o,quantizationParameters:u,returnGeometry:l,returnCentroid:c,maxAllowableOffset:d,resultOffset:f,resultRecordCount:p,returnZ:g=!1,returnM:y=!1}=e,I=n&&g,b=r&&y;let x=[],F=0;const T=[...t];if(this._sortFeatures(T,o,((e,t,s)=>i.getFieldValue(e,t,s))),l||c){const e=s(u);if(l&&!c)for(const t of T)x[F++]={attributes:i.getAttributes(t),geometry:h(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),d,e,I,b)};else if(!l&&c)for(const t of T)x[F++]={attributes:i.getAttributes(t),centroid:m(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of T)x[F++]={attributes:i.getAttributes(t),centroid:m(this,this.featureAdapter.getCentroid(t,this),e),geometry:h(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),d,e,I,b)}}else for(const s of T){const e=i.getAttributes(s);e&&(x[F++]={attributes:e})}const V=f||0;if(null!=p){const e=V+p;x=x.slice(V,Math.min(x.length,e))}return x}_createExceedsLimitQueryResponse(e){let s=!1,i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if(\"exceedslimit\"===t.statisticType){i=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,r=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,n=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if(\"esriGeometryPoint\"===this.geometryType)s=this.items.length>i;else if(this.items.length>r)s=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,i=this.featureAdapter;s=this.items.reduce(((e,s)=>{const r=i.getGeometry(s);return e+(t(r)&&r.coords.length||0)}),0)/e>n}return{fields:[{name:\"exceedslimit\",type:\"esriFieldTypeInteger\",alias:\"exceedslimit\",sqlType:\"sqlTypeInteger\",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(s)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},s=[],i=new Map,r=new Map,n=new Map,o=new Map,u=new a(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,{groupByFieldsForStatistics:c,having:d,orderByFields:h}=e,m=c&&c.length,f=!!m,p=f&&c[0],g=f&&!this.fieldsIndex.get(p);for(const a of l){const{outStatisticFieldName:e,statisticType:l}=a,h=a,y=\"exceedslimit\"!==l?a.onStatisticField:void 0,I=\"percentile_disc\"===l||\"percentile_cont\"===l,b=f&&1===m&&(y===p||g)&&\"count\"===l;if(f){if(!n.has(y)){const e=[];for(const t of c){const s=this._getAttributeValues(u,t,i);e.push(s)}n.set(y,this._calculateUniqueValues(e,u.returnDistinctValues))}const t=n.get(y);for(const s in t){const{count:r,data:n,items:a,itemPositions:l}=t[s],m=n.join(\",\");if(!d||u.validateItems(a,d)){const t=o.get(m)||{attributes:{}};let s=null;if(b)s=r;else{const e=this._getAttributeValues(u,y,i),t=l.map((t=>e[t]));s=I&&\"statisticParameters\"in h?this._getPercentileValue(h,t):this._getStatisticValue(h,t,null,u.returnDistinctValues)}t.attributes[e]=s,c.forEach(((e,s)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${s+1}`]=n[s])),o.set(m,t)}}}else{const s=this._getAttributeValues(u,y,i);t.attributes[e]=I&&\"statisticParameters\"in h?this._getPercentileValue(h,s):this._getStatisticValue(h,s,r,u.returnDistinctValues)}s.push({name:e,alias:e,type:\"esriFieldTypeDouble\"})}const y=f?Array.from(o.values()):[t];return this._sortFeatures(y,h,((e,t)=>e.attributes[t])),{fields:s,features:y}}_getStatisticValue(e,t,s,i){const{onStatisticField:r,statisticType:n}=e;let a=null;a=null!=s&&s.has(r)?s.get(r):f(this.fieldsIndex.get(r))?g({values:t,returnDistinct:i}):y({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),s&&s.set(r,a);return a[\"var\"===n?\"variance\":n]}_getPercentileValue(e,t){const{onStatisticField:s,statisticParameters:i,statisticType:r}=e,{value:n,orderBy:a}=i,o=\"desc\"===a,u=this.fieldsIndex.get(s),l=[...t].filter((e=>null!=e)).sort(((e,t)=>V(e,t,u,o)));return this._calculatePercentile(l,n,\"percentile_disc\"===r)}_getAttributeValues(e,t,s){if(s.has(t))return s.get(t);const i=this.fieldsIndex.get(t),r=this.items.map((s=>e.getFieldValue(s,t,i)));return s.set(t,r),r}_getAttributeNormalizedValues(e,t){return this.items.map((s=>e.getNormalizedValue(s,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,s){const{arcadeUtils:i}=await b(),r=i.createFunction(t),n=s&&i.getViewInfo(s);return this.items.map((t=>e.getExpressionValue(t,{compiledFunc:r,viewInfo:n},i)))}_calculateUniqueValues(e,t){const s={},i=this.items,r=i.length;for(let n=0;n<r;n++){const r=i[n],a=[];for(const t of e)a.push(t[n]);const o=a.join(\",\");t?null==s[o]&&(s[o]={count:1,data:a,items:[r],itemPositions:[n]}):null==s[o]?s[o]={count:1,data:a,items:[r],itemPositions:[n]}:(s[o].count++,s[o].items.push(r),s[o].itemPositions.push(n))}return s}_calculatePercentile(e,t,s){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];const i=(e.length-1)*t,r=Math.floor(i),n=r+1,a=i%1,o=e[r],u=e[n];return n>=e.length||s||\"string\"==typeof o||\"string\"==typeof u?o:o*(1-a)+u*a}}function S(e,t,s,i,r,n){const a=r-s,o=n-i,u=a*a+o*o,l=(e-s)*a+(t-i)*o,c=Math.min(1,Math.max(0,l/u));return{x:s+a*c,y:i+o*c}}function _(e,t){return e?t?4:3:t?3:2}export{A as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{WhereClauseCache as i}from\"../../../core/sql/WhereClauseCache.js\";const s=new i(50,500),n=\"feature-store:unsupported-query\",t=\" as \",r=new Set([\"esriFieldTypeOID\",\"esriFieldTypeSmallInteger\",\"esriFieldTypeInteger\",\"esriFieldTypeSingle\",\"esriFieldTypeDouble\",\"esriFieldTypeLong\",\"esriFieldTypeDate\"]);function o(i,t){if(!t)return!0;const r=s.get(t,i);if(!r)throw new e(n,\"invalid SQL expression\",{where:t});if(!r.isStandardized)throw new e(n,\"where clause is not standard\",{where:t});return c(i,r.fieldNames,\"where clause contains missing fields\"),!0}function a(i,t,r){if(!t)return!0;const o=s.get(t,i);if(!o)throw new e(n,\"invalid SQL expression\",{having:t});if(!o.isAggregate)throw new e(n,\"having does not contain a valid aggregate function\",{having:t});const a=o.fieldNames;c(i,a,\"having contains missing fields\");if(!o.getExpressions().every((e=>{const{aggregateType:s,field:n}=e,t=i.has(n)&&i.get(n).name;return r.some((e=>{const{onStatisticField:n,statisticType:r}=e;return(i.has(n)&&i.get(n).name)===t&&r.toLowerCase().trim()===s}))})))throw new e(n,\"expressions in having should also exist in outStatistics\",{having:t});return!0}function l(e,i){return e?s.get(e,i):null}function c(i,s,t,r=!0){const o=[];for(const u of s)if(\"*\"!==u&&!i.has(u))if(r){const s=d(u);try{const t=l(s,i);if(!t)throw new e(n,\"invalid SQL expression\",{where:s});if(!t.isStandardized)throw new e(n,\"expression is not standard\",{clause:t});c(i,t.fieldNames,\"expression contains missing fields\")}catch(a){const e=a&&a.details;if(e&&(e.clause||e.where))throw a;e&&e.missingFields?o.push(...e.missingFields):o.push(u)}}else o.push(u);if(o.length)throw new e(n,t,{missingFields:o})}function d(e){return e.split(t)[0]}function u(e){return e.split(t)[1]}function f(e,i){const s=i.get(e);return!!s&&!r.has(s.type)}export{u as getAliasFromFieldName,d as getExpressionFromFieldName,l as getWhereClause,f as hasInvalidFieldType,c as validateFields,a as validateHaving,o as validateWhere};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{extentContainsPoint as r,extentContainsMultipoint as t}from\"../../../geometry/support/contains.js\";import{getExtentIntersector as i}from\"../../../geometry/support/intersects.js\";import{isPolygon as s,isExtent as o,getJsonType as n}from\"../../../geometry/support/jsonUtils.js\";import{isValid as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{polygonContainsPoint as a,polygonContainsMultipoint as p}from\"../contains.js\";import{convertFromPolygon as m}from\"../featureConversionUtils.js\";import u from\"../OptimizedGeometry.js\";import{checkProjectionSupport as y}from\"./projectionSupport.js\";import{getGeometry as f}from\"./utils.js\";const c=\"feature-store:unsupported-query\",R={esriSpatialRelIntersects:\"intersects\",esriSpatialRelContains:\"contains\",esriSpatialRelCrosses:\"crosses\",esriSpatialRelDisjoint:\"disjoint\",esriSpatialRelEnvelopeIntersects:\"intersects\",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:\"overlaps\",esriSpatialRelTouches:\"touches\",esriSpatialRelWithin:\"within\",esriSpatialRelRelation:null},S={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function G(e){return!0===S.spatialRelationship[e]}function g(e){return!0===S.queryGeometry[n(e)]}function j(e){return!0===S.layerGeometry[e]}function h(){return import(\"../../../geometry/geometryEngineJSON.js\")}function v(e,n,l,y,c){if(s(n)&&\"esriGeometryPoint\"===l&&(\"esriSpatialRelIntersects\"===e||\"esriSpatialRelContains\"===e)){const e=m(new u,n,!1,!1);return Promise.resolve((r=>a(e,!1,!1,r)))}if(s(n)&&\"esriGeometryMultipoint\"===l){const r=m(new u,n,!1,!1);if(\"esriSpatialRelContains\"===e)return Promise.resolve((e=>p(r,!1,!1,e,y,c)))}if(o(n)&&\"esriGeometryPoint\"===l&&(\"esriSpatialRelIntersects\"===e||\"esriSpatialRelContains\"===e))return Promise.resolve((e=>r(n,f(l,y,c,e))));if(o(n)&&\"esriGeometryMultipoint\"===l&&\"esriSpatialRelContains\"===e)return Promise.resolve((e=>t(n,f(l,y,c,e))));if(o(n)&&\"esriSpatialRelIntersects\"===e){const e=i(l);return Promise.resolve((r=>e(n,f(l,y,c,r))))}return h().then((r=>{const t=r[R[e]].bind(null,n.spatialReference,n);return e=>t(f(l,y,c,e))}))}async function P(r,t,i){const{spatialRel:s,geometry:o}=r;if(o){if(!G(s))throw new e(c,\"Unsupported query spatial relationship\",{query:r});if(l(o.spatialReference)&&l(i)){if(!g(o))throw new e(c,\"Unsupported query geometry type\",{query:r});if(!j(t))throw new e(c,\"Unsupported layer geometry type\",{query:r});if(r.outSR)return y(r.geometry&&r.geometry.spatialReference,r.outSR)}}}function I(e){if(o(e))return!0;if(s(e)){for(const r of e.rings){if(5!==r.length)return!1;if(r[0][0]!==r[1][0]||r[0][0]!==r[4][0]||r[2][0]!==r[3][0]||r[0][1]!==r[3][1]||r[0][1]!==r[4][1]||r[1][1]!==r[2][1])return!1}return!0}return!1}export{I as canQueryWithRBush,P as checkSpatialQuerySupport,v as getSpatialQueryOperator};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nfunction t(t,n){if(!t)return null;const e=n.featureAdapter,{startTimeField:u,endTimeField:l}=t;let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(u&&l)n.forEach((t=>{const n=e.getAttribute(t,u),o=e.getAttribute(t,l);null==n||isNaN(n)||(r=Math.min(r,n)),null==o||isNaN(o)||(i=Math.max(i,o))}));else{const t=u||l;n.forEach((n=>{const u=e.getAttribute(n,t);null==u||isNaN(u)||(r=Math.min(r,u),i=Math.max(i,u))}))}return{start:r,end:i}}function n(t,n,r){if(!n||!t)return null;const{startTimeField:i,endTimeField:o}=t;if(!i&&!o)return null;const{start:s,end:a}=n;return null===s&&null===a?null:void 0===s&&void 0===a?l():i&&o?e(r,i,o,s,a):u(r,i||o,s,a)}function e(t,n,e,u,l){return null!=u&&null!=l?r=>{const i=t.getAttribute(r,n),o=t.getAttribute(r,e);return(null==i||i<=l)&&(null==o||o>=u)}:null!=u?n=>{const l=t.getAttribute(n,e);return null==l||l>=u}:null!=l?e=>{const u=t.getAttribute(e,n);return null==u||u<=l}:void 0}function u(t,n,e,u){return null!=e&&null!=u&&e===u?u=>t.getAttribute(u,n)===e:null!=e&&null!=u?l=>{const r=t.getAttribute(l,n);return r>=e&&r<=u}:null!=e?u=>t.getAttribute(u,n)>=e:null!=u?e=>t.getAttribute(e,n)<=u:void 0}function l(){return()=>!1}export{t as getTimeExtent,n as getTimeOperator};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{JSONMap as e}from\"../../../core/jsonMap.js\";import{isNone as t,isSome as r}from\"../../../core/maybe.js\";import{getUnitString as i}from\"../../../core/unitUtils.js\";import{getGeometryExtent as o}from\"../../../geometry/support/extentUtils.js\";import{fromJSON as n}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as s}from\"../../../geometry/support/normalizeUtils.js\";import{isGeographic as l,isWebMercator as a,WGS84 as m}from\"../../../geometry/support/spatialReferenceUtils.js\";import{getCentroidOptimizedGeometry as c}from\"../centroid.js\";import{quantizeOptimizedGeometry as u,convertToPoint as f,generalizeOptimizedGeometry as p,removeZMValues as y,convertToPolyline as g,convertToPolygon as S,convertToMultipoint as R}from\"../featureConversionUtils.js\";import d from\"../OptimizedGeometry.js\";import{checkProjectionSupport as h,project as w}from\"./projectionSupport.js\";const j=new e({esriSRUnit_Meter:\"meters\",esriSRUnit_Kilometer:\"kilometers\",esriSRUnit_Foot:\"feet\",esriSRUnit_StatuteMile:\"miles\",esriSRUnit_NauticalMile:\"nautical-miles\",esriSRUnit_USNauticalMile:\"us-nautical-miles\"}),U=Object.freeze({}),M=new d,F=new d,G=new d,N={esriGeometryPoint:f,esriGeometryPolyline:g,esriGeometryPolygon:S,esriGeometryMultipoint:R};function O(e,r,i,o=e.hasZ,n=e.hasM){if(t(r))return null;const s=e.hasZ&&o,l=e.hasM&&n;if(i){const t=u(G,r,e.hasZ,e.hasM,\"esriGeometryPoint\",i,o,n);return f(t,s,l)}return f(r,s,l)}function _(e,t,r){return\"esriGeometryPolygon\"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=c(new d,t.geometry,e.hasZ,e.hasM)),O(e,t.centroid,r)):null}function J(e,i,o,n,s,l,a=i,m=o){const c=i&&a,f=o&&m,g=r(n)?\"coords\"in n?n:n.geometry:null;if(t(g))return null;if(s){let t=p(F,g,i,o,e,s,a,m);return l&&(t=u(G,t,c,f,e,l)),N[e](t,c,f)}if(l){const t=u(G,g,i,o,e,l,a,m);return N[e](t,c,f)}return y(M,g,i,o,a,m),N[e](M,c,f)}async function P(e,t,r){const{outFields:i,orderByFields:o,groupByFieldsForStatistics:n,outStatistics:s}=e;if(i)for(let l=0;l<i.length;l++)i[l]=i[l].trim();if(o)for(let l=0;l<o.length;l++)o[l]=o[l].trim();if(n)for(let l=0;l<n.length;l++)n[l]=n[l].trim();if(s)for(let l=0;l<s.length;l++)s[l].onStatisticField&&(s[l].onStatisticField=s[l].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),Z(e,t,r)}async function v(e,t,r){return Z(e,t,r)}async function Z(e,r,i){if(!e)return null;let{where:l}=e;if(e.where=l=l&&l.trim(),(!l||/^1 *= *1$/.test(l)||r&&r===l)&&(e.where=null),!e.geometry)return e;let a=await b(e);if(e.distance=0,e.units=null,\"esriSpatialRelEnvelopeIntersects\"===e.spatialRel){const{spatialReference:t}=e.geometry;a=o(a),a.spatialReference=t}e.geometry=a,await h(a.spatialReference,i);const m=(await s(n(a)))[0];if(t(m))throw U;const c=m.toJSON(),u=await w(c,c.spatialReference,i);if(!u)throw U;return u.spatialReference=i,e.geometry=u,e}async function b(e){const{geometry:t,distance:r,units:o}=e;if(null==r||\"vertexAttributes\"in t)return t;const n=t.spatialReference,s=o?j.fromJSON(o):i(n),c=n&&(l(n)||a(n))?t:await h(n,m).then((()=>w(t,m)));return(await x())(c.spatialReference,c,r,s)}async function x(){return(await import(\"../../../geometry/geometryEngineJSON.js\")).geodesicBuffer}function z(e){return e&&B in e?JSON.parse(JSON.stringify(e,E)):e}const B=\"_geVersion\",E=(e,t)=>e!==B?t:void 0;export{U as QUERY_ENGINE_EMPTY_RESULT,z as cleanFromGeometryEngine,_ as getCentroid,J as getGeometry,v as normalizeFilter,P as normalizeQuery,Z as normalizeQueryLike,O as transformCentroid};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isAborted as s,createAbortError as t,isPromise as e}from\"../../core/promiseUtils.js\";class r{constructor(){this._tasks=new Array}get length(){return this._tasks.length}push(s,t,e){return new Promise(((r,l)=>this._tasks.push(new a(r,l,s,t,e))))}unshift(s,t,e){return new Promise(((r,l)=>this._tasks.unshift(new a(r,l,s,t,e))))}process(){if(0===this._tasks.length)return!1;const r=this._tasks.shift();try{const a=s(r.signal);if(a&&!r.abortCallback)r.reject(t());else{const s=a?r.abortCallback(t()):r.callback();e(s)?s.then(r.resolve,r.reject):r.resolve(s)}}catch(a){r.reject(a)}return!0}cancelAll(){const s=t();for(const t of this._tasks)if(t.abortCallback){const e=t.abortCallback(s);t.resolve(e)}else t.reject(s);this._tasks.length=0}}class a{constructor(s,t,e,r,a){this.resolve=s,this.reject=t,this.callback=e,this.signal=r,this.abortCallback=a}}export{r as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{isSome as n}from\"../../../core/maybe.js\";import{isNumericField as t,numericTypes as l}from\"../../../layers/support/fieldUtils.js\";function o(e){const n=null!=e.normalizationField||null!=e.normalizationType,t=null!=e.minValue||null!=e.maxValue,l=!!e.sqlExpression&&e.supportsSQLExpression;return!n&&!t&&!l}function i(e){const n=e.returnDistinct?[...new Set(e.values)]:e.values,t=n.filter((e=>null!=e)).length,l={count:t};return e.supportsNullCount&&(l.nullcount=n.length-t),l}function r(e){const{values:n,useSampleStdDev:t,supportsNullCount:l}=e;let o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=null,u=null,s=null,a=null,c=0;const f=null==e.minValue?-1/0:e.minValue,d=null==e.maxValue?1/0:e.maxValue;for(const p of n)Number.isFinite(p)?p>=f&&p<=d&&(r+=p,o=Math.min(o,p),i=Math.max(i,p),c++):\"string\"==typeof p&&c++;if(c&&null!=r){u=r/c;let e=0;for(const t of n)Number.isFinite(t)&&t>=f&&t<=d&&(e+=(t-u)**2);a=t?c>1?e/(c-1):0:c>0?e/c:0,s=Math.sqrt(a)}else o=null,i=null;const m={avg:u,count:c,max:i,min:o,stddev:s,sum:r,variance:a};return l&&(m.nullcount=n.length-c),m}function u(e,n){return n?([\"avg\",\"stddev\",\"variance\"].forEach((n=>{null!=e[n]&&(e[n]=Math.ceil(e[n]))})),e):e}function s(e,n,t,l){let o=null;switch(n){case\"log\":0!==e&&(o=Math.log(e)*Math.LOG10E);break;case\"percent-of-total\":Number.isFinite(l)&&0!==l&&(o=e/l*100);break;case\"field\":Number.isFinite(t)&&0!==t&&(o=e/t);break;case\"natural-log\":e>0&&(o=Math.log(e));break;case\"square-root\":e>0&&(o=e**.5)}return o}function a(e){const n=e.field,t=e.normalizationType,l=e.normalizationField;let o;return\"log\"===t?o=\"(NOT \"+n+\" = 0)\":\"field\"===t?o=\"(NOT \"+l+\" = 0)\":\"natural-log\"!==t&&\"square-root\"!==t||(o=`(${n} > 0)`),o}function c(n,t){return new e(n,t)}function f(e,n,t){const l=null!=n?e+\" >= \"+n:\"\",o=null!=t?e+\" <= \"+t:\"\";let i=\"\";return i=l&&o?p(l,o):l||o,i?\"(\"+i+\")\":\"\"}function d(e,n,t,l){let o=null;return n?n.name!==e.objectIdField&&-1!==l.indexOf(n.type)||(o=c(t,\"'field' should be one of these types: \"+l.join(\",\"))):o=c(t,\"'field' is not defined in the layer schema\"),o}function m(e,n,o){let i;return n?n.name!==e.objectIdField&&t(n)||(i=c(o,\"'field' should be one of these numeric types: \"+l.join(\",\"))):i=c(o,\"'field' is not defined in the layer schema\"),i}function p(e,t){let l=n(e)?e:\"\";return n(t)&&t&&(l=l?\"(\"+l+\") AND (\"+t+\")\":t),l}function h(e,n,t){const l=g({layer:e,fields:n});if(l.length)return c(t,\"Unknown fields: \"+l.join(\", \")+\". You can only use fields defined in the layer schema\");const o=b({layer:e,fields:n});return o.length?c(t,\"Unsupported fields: \"+o.join(\", \")+\". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true\"):void 0}function g(e){const n=e.layer;return e.fields.filter((e=>!n.getField(e)))}function b(e){const n=e.layer;return e.fields.filter((e=>{const t=n.getFieldUsageInfo(e);return!t||!t.supportsStatistics}))}export{r as calculateStatistics,i as calculateStringStatistics,c as createError,s as getNormalizedValue,f as getRangeExpr,a as getSQLFilterForNormalization,o as isNullCountSupported,p as mergeWhereClauses,u as processStatsResult,h as verifyBasicFieldValidity,d as verifyFieldType,m as verifyNumericField};\n"],"sourceRoot":""}