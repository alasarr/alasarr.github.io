{"version":3,"sources":["webpack://lib/../node_modules/@arcgis/core/core/asyncUtils.js","webpack://lib/../node_modules/@arcgis/core/layers/effects/jsonUtils.js","webpack://lib/../node_modules/@arcgis/core/layers/mixins/BlendLayer.js","webpack://lib/../node_modules/@arcgis/core/layers/mixins/CustomParametersMixin.js","webpack://lib/../node_modules/@arcgis/core/layers/mixins/PortalLayer.js","webpack://lib/../node_modules/@arcgis/core/layers/mixins/RefreshableLayer.js","webpack://lib/../node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js","webpack://lib/../node_modules/@arcgis/core/layers/mixins/refresh.js","webpack://lib/../node_modules/@arcgis/core/support/popupUtils.js"],"names":[],"mappings":"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","file":"11.render-page.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isNone as r}from\"./maybe.js\";import{eachAlways as o,resolve as t,throwIfAbortError as e}from\"./promiseUtils.js\";function n(r,t,e){return o(r.map(((r,o)=>t.apply(e,[r,o]))))}function u(r,t,e){return o(r.map(((r,o)=>t.apply(e,[r,o])))).then((r=>r.map((r=>r.value))))}function a(o){return r(o)?t():o.then((r=>({ok:!0,value:r}))).catch((r=>({ok:!1,error:r})))}function p(r){return r.then((r=>({ok:!0,value:r}))).catch((r=>(e(r),{ok:!1,error:r})))}function i(r){if(!0===r.ok)return r.value;throw r.error}export{i as assertResult,n as forEach,u as map,a as result,p as resultOrAbort};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{setDeepValue as r}from\"../../core/object.js\";import{parse as t}from\"./parser.js\";function s(e,r,t){try{return a(e)}catch(s){t.messages&&t.messages.push(s)}return null}function n(e,t,s,n){try{const n=o(e);n&&r(s,n,t)}catch(a){n.messages&&n.messages.push(a)}}function o(e){if(!e)return null;if(\"string\"==typeof e)return f(e);const r=[];for(const{scale:t,value:s}of e)r.push({scale:t,value:f(s)});return r}function a(e){if(!e)return null;if(c(e)){const r=[];for(const t of e)r.push({scale:t.scale,value:u(t.value)});return r}return u(e)}function c(e){const r=e[0];return!!r&&\"scale\"in r}function f(e){if(!e)return null;const r=t(e);if(r.error)throw r.error;return r.effects.map((e=>e.toJSON()))}function u(e){if(!e||!e.length)return null;const r=[];for(const s of e){let e=[];switch(s.type){case\"grayscale\":case\"sepia\":case\"saturate\":case\"invert\":case\"brightness\":case\"contrast\":case\"opacity\":e=[i(s,\"amount\")];break;case\"blur\":e=[i(s,\"radius\",\"pt\")];break;case\"hue-rotate\":e=[i(s,\"angle\",\"deg\")];break;case\"drop-shadow\":e=[i(s,\"xoffset\",\"pt\"),i(s,\"yoffset\",\"pt\"),i(s,\"blurRadius\",\"pt\"),l(s,\"color\")];break;case\"bloom\":e=[i(s,\"strength\"),i(s,\"radius\",\"pt\"),i(s,\"threshold\")]}const n=`${s.type}(${e.filter(Boolean).join(\" \")})`,o=t(n);if(o.error)throw o.error;r.push(n)}return r.join(\" \")}function i(r,t,s){if(null==r[t])throw new e(\"effect:missing-parameter\",`Missing parameter '${t}' in ${r.type} effect`,{effect:r});return s?r[t]+s:\"\"+r[t]}function l(r,t){if(null==r[t])throw new e(\"effect:missing-parameter\",`Missing parameter '${t}' in ${r.type} effect`,{effect:r});const s=r[t];return`rgba(${s[0]||0} ${s[1]||0} ${s[2]||0} ${s[3]/255||0})`}export{u as effectFunctionsFromJSON,f as effectFunctionsToJSON,a as fromJSON,s as read,o as toJSON,n as write};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{read as t,write as s}from\"../effects/jsonUtils.js\";const i=i=>{let n=class extends i{constructor(){super(...arguments),this.blendMode=\"normal\",this.effect=null}};return e([r({type:[\"average\",\"color-burn\",\"color-dodge\",\"color\",\"darken\",\"destination-atop\",\"destination-in\",\"destination-out\",\"destination-over\",\"difference\",\"exclusion\",\"hard-light\",\"hue\",\"invert\",\"lighten\",\"lighter\",\"luminosity\",\"minus\",\"multiply\",\"normal\",\"overlay\",\"plus\",\"reflect\",\"saturation\",\"screen\",\"soft-light\",\"source-atop\",\"source-in\",\"source-out\",\"vivid-light\",\"xor\"],nonNullable:!0,json:{read:!1,write:!1,origins:{\"web-map\":{default:\"normal\",read:!0,write:!0}}}})],n.prototype,\"blendMode\",void 0),e([r({json:{read:!1,write:!1,origins:{\"web-map\":{read:{reader:t},write:{writer:s}}}}})],n.prototype,\"effect\",void 0),n=e([o(\"esri.layers.mixins.BlendLayer\")],n),n};export{i as BlendLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";const o=o=>{let t=class extends o{constructor(){super(...arguments),this.customParameters=null}};return r([e({type:Object,json:{write:{overridePolicy:r=>({enabled:!!(r&&Object.keys(r).length>0)})}}})],t.prototype,\"customParameters\",void 0),t=r([s(\"esri.layers.mixins.CustomParametersMixin\")],t),t};export{o as CustomParametersMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import{id as e}from\"../../kernel.js\";import r from\"../../request.js\";import{result as s}from\"../../core/asyncUtils.js\";import o from\"../../core/Error.js\";import i from\"../../core/Logger.js\";import{isNone as a,isSome as l}from\"../../core/maybe.js\";import{throwIfAborted as n,isAbortError as p,throwIfAbortError as m}from\"../../core/promiseUtils.js\";import{normalize as u,hasSamePortal as c}from\"../../core/urlUtils.js\";import{property as d}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{reader as h}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as f}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as y}from\"../../core/accessorSupport/decorators/writer.js\";import g from\"../../portal/Portal.js\";import I from\"../../portal/PortalItem.js\";import v from\"../../portal/PortalUser.js\";const j=i.getLogger(\"esri.layers.mixins.PortalLayer\"),w=i=>{let w=class extends i{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0}destroy(){var t;null==(t=this.portalItem)||t.destroy(),this.portalItem=null}set portalItem(t){t!==this._get(\"portalItem\")&&(this.removeOrigin(\"portal-item\"),this._set(\"portalItem\",t))}readPortalItem(t,e,r){if(e.itemId)return new I({id:e.itemId,portal:r&&r.portal})}writePortalItem(t,e){t&&t.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem&&this.portalItem.id)try{const r=await import(\"../../portal/support/layersLoader.js\");return n(e),await r.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},e)}catch(r){throw p(r)||j.warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\\n  ${r}`),r}}async finishLoadEditablePortalLayer(t){this._set(\"userHasEditingPrivileges\",await this.fetchUserHasEditingPrivileges(t).catch((t=>(m(t),!0))))}async fetchUserHasEditingPrivileges(t){const r=this.url?null==e?void 0:e.findCredential(this.url):null;if(!r)return!0;const s=P.credential===r?P.user:await this.fetchEditingUser(t);return P.credential=r,P.user=s,a(s)||null==s.privileges||s.privileges.includes(\"features:user:edit\")}async fetchEditingUser(t){var o,i;const a=null==(o=this.portalItem)||null==(i=o.portal)?void 0:i.user;if(a)return a;const n=e.findServerInfo(this.url);if(null==n||!n.owningSystemUrl)return null;const p=`${n.owningSystemUrl}/sharing/rest`,m=g.getDefault();if(m&&m.loaded&&u(m.restUrl)===u(p))return m.user;const c=`${p}/community/self`,d=l(t)?t.signal:null,h=await s(r(c,{authMode:\"no-prompt\",query:{f:\"json\"},signal:d}));return h.ok?v.fromJSON(h.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const r=e&&e.portal,s=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||g.getDefault());return r&&s&&!c(s.restUrl,r.restUrl)?(e.messages&&e.messages.push(new o(\"layer:cross-portal\",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return t([d({type:I})],w.prototype,\"portalItem\",null),t([h(\"web-document\",\"portalItem\",[\"itemId\"])],w.prototype,\"readPortalItem\",null),t([y(\"web-document\",\"portalItem\",{itemId:{type:String}})],w.prototype,\"writePortalItem\",null),t([d()],w.prototype,\"resourceReferences\",void 0),t([d({readOnly:!0})],w.prototype,\"userHasEditingPrivileges\",void 0),w=t([f(\"esri.layers.mixins.PortalLayer\")],w),w},P={credential:null,user:null};export{w as PortalLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Logger.js\";import{debounce as s,ignoreAbortErrors as t}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{registerLayer as i,unregisterLayer as h}from\"./refresh.js\";function n(e){return e&&\"object\"==typeof e&&\"refreshTimestamp\"in e&&\"refresh\"in e}const p=n=>{let p=class extends n{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=s((()=>this.hasDataChanged())),this.when().then((()=>{i(this)}),(()=>{}))}destroy(){h(this)}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){t(this._debounceHasDataChanged()).then((r=>{r&&(this._set(\"refreshTimestamp\",e),this.emit(\"refresh\"))}),(e=>{r.getLogger(this.declaredClass).error(e)}))}async hasDataChanged(){return!0}};return e([o({type:Number,cast:e=>e>=.1?e:e<=0?0:.1,json:{write:!0,origins:{\"web-document\":{write:!0}}}})],p.prototype,\"refreshInterval\",void 0),e([o({readOnly:!0})],p.prototype,\"refreshTimestamp\",void 0),e([o()],p.prototype,\"refreshParameters\",null),p=e([a(\"esri.layers.mixins.RefreshableLayer\")],p),p};export{p as RefreshableLayer,n as isRefreshableLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";const s=s=>{let t=class extends s{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get scaleRangeId(){return`${this.minScale},${this.maxScale}`}};return e([r({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,\"minScale\",void 0),e([r({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,\"maxScale\",void 0),e([r({readOnly:!0})],t.prototype,\"scaleRangeId\",null),t=e([o(\"esri.layers.mixins.ScaleRangeLayer\")],t),t};export{s as ScaleRangeLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import{autorun as r}from\"../../core/accessorSupport/trackingUtils.js\";const t=new e,n=new WeakMap;function o(e){f(e)&&t.push(e)}function s(e){f(e)&&t.includes(e)&&t.remove(e)}function f(e){return e&&\"object\"==typeof e&&\"refreshInterval\"in e&&\"refresh\"in e}function i(e,r){return Number.isFinite(e)&&Number.isFinite(r)?r<=0?e:i(r,e%r):0}let c=0,l=0;function a(){const e=Date.now();for(const o of t)if(o.refreshInterval){var r;e-(null!=(r=n.get(o))?r:0)+5>=6e4*o.refreshInterval&&(n.set(o,e),o.refresh(e))}}r((()=>{const e=Date.now();let r=0;for(const o of t)r=i(Math.round(6e4*o.refreshInterval),r),o.refreshInterval?n.get(o)||n.set(o,e):n.delete(o);if(r!==l){if(l=r,clearInterval(c),0===l)return void(c=0);c=setInterval(a,l)}}));const u={get hasRefreshTimer(){return c>0},get tickInterval(){return l},forceRefresh(){a()},hasLayer:e=>f(e)&&t.includes(e),clear(){for(const e of t)n.delete(e);t.removeAll()}};export{o as registerLayer,u as test,s as unregisterLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../PopupTemplate.js\";import{getDisplayFieldName as t}from\"../layers/support/fieldUtils.js\";import i from\"../popup/content/AttachmentsContent.js\";import\"../popup/content/Content.js\";import\"../popup/content/CustomContent.js\";import o from\"../popup/content/FieldsContent.js\";import\"../popup/content/MediaContent.js\";import\"../popup/content/TextContent.js\";import n from\"../popup/FieldInfo.js\";import r from\"../popup/support/FieldInfoFormat.js\";const l=[\"oid\",\"global-id\"],s=[\"oid\",\"global-id\",\"guid\"];function a({displayField:t,editFieldsInfo:i,fields:o,objectIdField:n,title:r},l){if(!o)return null;const s=b({editFieldsInfo:i,fields:o,objectIdField:n},l);if(!s.length)return null;const a=j({titleBase:r,fields:o,displayField:t}),d=C();return new e({title:a,content:d,fieldInfos:s})}const d=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],p=(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:o})=>o?o.has(e.name):!f(e.name,t)&&((!i||e.name!==i)&&(!(l.indexOf(e.type)>-1)&&!d.some((t=>t.test(e.name)))));function u(e,t){const i=e;return t&&(e=e.filter((e=>-1===t.indexOf(e.type)))),e===i&&(e=e.slice()),e.sort(c),e}function c(e,t){return\"oid\"===e.type?-1:\"oid\"===t.type?1:y(e)?-1:y(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function f(e,t){if(!e||!t)return!1;const{creationDateField:i,creatorField:o,editDateField:n,editorField:r}=t;return-1!==[i&&i.toLowerCase(),o&&o.toLowerCase(),n&&n.toLowerCase(),r&&r.toLowerCase()].indexOf(e.toLowerCase())}function m(e,t){return e.editable&&-1===s.indexOf(e.type)&&!f(e.name,t)}function F(e,t){return new o({fieldInfos:b(e,t).filter((e=>e.visible))})}function b({editFieldsInfo:e,fields:t,objectIdField:i},o){return u(t,(null==o?void 0:o.ignoreFieldTypes)||g).map((t=>new n({fieldName:t.name,isEditable:m(t,e),label:t.alias,format:w(t),visible:p(t,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:null==o?void 0:o.visibleFieldNames})})))}function w(e){switch(e.type){case\"small-integer\":case\"integer\":case\"single\":return new r({digitSeparator:!0,places:0});case\"double\":return new r({digitSeparator:!0,places:2});case\"date\":return new r({dateFormat:\"long-month-day-year\"});default:return null}}function C(){return[new o,new i]}function j(e){const i=t(e),{titleBase:o}=e;return i?`${o}: {${i.trim()}}`:o}function y(e){if(\"name\"===(e.name&&e.name.toLowerCase()))return!0;return\"name\"===(e.alias&&e.alias.toLowerCase())||void 0}const g=[\"geometry\",\"blob\",\"raster\",\"guid\",\"xml\"];export{b as createFieldInfos,F as createFieldsContent,a as createPopupTemplate};\n"],"sourceRoot":""}